<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Three.js + Audio Starter ‚Äî Plus</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./src/styles.css">
</head>
<body class="bg-deep-bg text-deep-text dark:bg-dark-bg dark:text-dark-text">
  <div id="app"></div>

  <!-- Top HUD -->
    <div id="appControls" class="fixed left-3 right-3 top-3 z-[1000] grid gap-1.5 p-2.5 bg-deep-panel dark:bg-dark-panel backdrop-blur rounded-xl shadow-[0_6px_24px_rgba(0,0,0,0.35)]">
    <div class="flex flex-wrap items-center gap-2">
      <button id="micBtn" title="Use Microphone" class="hover:bg-[#22365d]">üéôÔ∏è Mic</button>
      <input id="fileInput" type="file" accept="audio/*" multiple title="Add audio files"/>
      <button id="playBtn" title="Play / Pause" class="hover:bg-[#22365d]">‚èµ</button>
      <button id="loopBtn" title="Loop Mode" class="hover:bg-[#22365d]">üîÅ</button>
      <input id="scrubber" type="range" min="0" max="0" step="0.01" value="0" />
      <span id="timeNow">0:00</span>
      <span id="timeRemain">-0:00</span>
      <label class="inline-flex items-center gap-1.5 text-deep-muted dark:text-dark-muted">
        üîä
        <canvas id="vuMeter" width="10" height="40" class="w-[10px] h-[40px] bg-white/10 rounded"></canvas>
        <canvas id="volumeKnob" width="50" height="50" class="w-[50px] h-[50px] bg-white/5 rounded-full cursor-pointer"></canvas>
        <input id="volume" type="range" min="0" max="1" step="0.01" value="0.8" hidden />
        <span id="volPct">80%</span>
      </label>
      <button id="btnFullscreen" title="Fullscreen" class="hover:bg-[#22365d]">‚õ∂</button>
      <button id="btnSettings" title="Settings" class="hover:bg-[#22365d]">‚öôÔ∏è</button>
      <button id="btnBeatConfig" title="Beat Settings" class="hover:bg-[#22365d]">üéöÔ∏è</button>
      <button id="btnPlaylist" title="Toggle Playlist" class="hover:bg-[#22365d]">üìú</button>
      <button id="smoothToggle" title="Smooth Transition" class="hover:bg-[#22365d]">Smooth</button>
    </div>

      <div class="flex flex-wrap items-center gap-3">
      <span id="trackTitle" class="font-semibold text-deep-text dark:text-dark-text">No track</span>
      <span id="trackStatus" class="text-deep-muted dark:text-dark-muted">stopped</span>

      <div class="grid grid-flow-col gap-2 items-center">
        <canvas id="miniSpec" width="260" height="60" class="w-[260px] h-[60px] bg-[rgba(255,255,255,0.03)] rounded-lg"></canvas>
        <canvas id="miniWave" width="260" height="60" class="w-[260px] h-[60px] bg-[rgba(255,255,255,0.03)] rounded-lg"></canvas>
      </div>

      <div class="inline-flex gap-1.5 items-center">
        <span id="ledSub"     class="text-[11px] px-1.5 py-[3px] rounded-lg bg-[rgba(255,255,255,0.08)] text-[#b9c9ff] border border-[rgba(255,255,255,0.08)] opacity-55">SUB</span>
        <span id="ledBass"    class="text-[11px] px-1.5 py-[3px] rounded-lg bg-[rgba(255,255,255,0.08)] text-[#b9c9ff] border border-[rgba(255,255,255,0.08)] opacity-55">BASS</span>
        <span id="ledLowMid"  class="text-[11px] px-1.5 py-[3px] rounded-lg bg-[rgba(255,255,255,0.08)] text-[#b9c9ff] border border-[rgba(255,255,255,0.08)] opacity-55">LOW‚ÄëMID</span>
        <span id="ledHighMid" class="text-[11px] px-1.5 py-[3px] rounded-lg bg-[rgba(255,255,255,0.08)] text-[#b9c9ff] border border-[rgba(255,255,255,0.08)] opacity-55">HIGH‚ÄëMID</span>
        <span id="ledHat"     class="text-[11px] px-1.5 py-[3px] rounded-lg bg-[rgba(255,255,255,0.08)] text-[#b9c9ff] border border-[rgba(255,255,255,0.08)] opacity-55">HI‚ÄëHAT</span>
      </div>
      </div>
    </div>

    <!-- Equalizer Panel -->
    <div id="eqPanel" class="fixed left-1/2 bottom-3 -translate-x-1/2 z-[1001] flex flex-col items-center gap-2 bg-deep-panel dark:bg-dark-panel backdrop-blur rounded-xl px-3 py-2.5 shadow-[0_6px_24px_rgba(0,0,0,0.35)]">
      <div id="eqSliders" class="flex gap-1.5 items-end h-[100px]">
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="0" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>32</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="1" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>64</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="2" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>125</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="3" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>250</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="4" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>500</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="5" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>1k</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="6" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>2k</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="7" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>4k</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="8" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>8k</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="9" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>16k</span></div>
      </div>
      <div class="flex gap-2.5 items-center text-[11px]">
        <div class="flex items-center gap-1">
          <label>HPF <input id="hpfSlider" type="range" min="20" max="1000" step="1" value="20" /></label>
          <label class="flex items-center gap-1"><input id="hpfAudioToggle" type="checkbox" checked />Audio</label>
          <label class="flex items-center gap-1"><input id="hpfLedToggle" type="checkbox" checked />LEDs</label>
        </div>
        <div class="flex items-center gap-1">
          <label>LPF <input id="lpfSlider" type="range" min="1000" max="20000" step="100" value="20000" /></label>
          <label class="flex items-center gap-1"><input id="lpfAudioToggle" type="checkbox" checked />Audio</label>
          <label class="flex items-center gap-1"><input id="lpfLedToggle" type="checkbox" checked />LEDs</label>
        </div>
        <label class="flex items-center gap-1"><input id="eqAudioToggle" type="checkbox" checked />Audio</label>
        <label class="flex items-center gap-1"><input id="eqLedToggle" type="checkbox" checked />LEDs</label>
        <label class="flex items-center gap-1"><input id="eqOverlayToggle" type="checkbox" />Overlay</label>
      </div>
      <div class="flex gap-1.5">
        <button class="eq-preset hover:bg-[#22365d]" data-preset="flat">Flat</button>
        <button class="eq-preset hover:bg-[#22365d]" data-preset="rock">Rock</button>
        <button class="eq-preset hover:bg-[#22365d]" data-preset="pop">Pop</button>
      </div>
    </div>

    <!-- Settings panel -->
    <div id="settingsPanel" class="fixed left-3 bottom-3 z-[1001] w-[280px] bg-deep-panel dark:bg-dark-panel text-deep-text dark:text-dark-text backdrop-blur rounded-xl px-3 py-2.5 shadow-[0_6px_24px_rgba(0,0,0,0.35)]" hidden>
    <div class="font-bold mb-2">Settings</div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>Theme</label>
      <select id="themeSel">
        <option value="deep">Deep Blue (default)</option>
        <option value="dark">Dark Grey</option>
      </select>
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>Bloom</label>
      <input id="bloomStrength" type="range" min="0" max="1.2" step="0.01" value="0.55" />
      <span id="bloomVal">0.55</span>
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>Fog density</label>
      <input id="fogDensity" type="range" min="0" max="0.15" step="0.001" value="0.06" />
      <span id="fogVal">0.06</span>
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>FXAA</label>
      <input id="fxaaToggle" type="checkbox" checked />
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>Film grain</label>
      <input id="filmToggle" type="checkbox" checked />
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>Chromatic ab.</label>
      <input id="rgbToggle" type="checkbox" checked />
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>Beat timeline</label>
      <input id="beatToggle" type="checkbox" />
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2" id="eqRow">
      <label>Equalizer</label>
      <div id="eqSliders" class="flex gap-1.5 items-end h-[100px]">
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="0" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>32</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="1" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>64</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="2" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>125</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="3" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>250</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="4" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>500</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="5" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>1k</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="6" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>2k</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="7" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>4k</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="8" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>8k</span></div>
        <div class="flex flex-col items-center text-[11px]"><input class="eq-slider w-2 h-20 [appearance:slider-vertical] [writing-mode:bt-lr]" data-band="9" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>16k</span></div>
      </div>
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2" id="eqPresetRow">
      <label>Presets</label>
      <div class="flex gap-1.5">
        <button class="eq-preset hover:bg-[#22365d]" data-preset="flat">Flat</button>
        <button class="eq-preset hover:bg-[#22365d]" data-preset="rock">Rock</button>
        <button class="eq-preset hover:bg-[#22365d]" data-preset="pop">Pop</button>
      </div>
    </div>
    <div class="flex justify-end gap-1.5">
      <button id="clearBeats" class="hover:bg-[#22365d]">Clear Beat Marks</button>
    </div>
  </div>

  <!-- Beat settings panel -->
  <div id="beatPanel" class="fixed right-3 bottom-3 z-[1001] w-[280px] bg-deep-panel dark:bg-dark-panel text-deep-text dark:text-dark-text backdrop-blur rounded-xl px-3 py-2.5 shadow-[0_6px_24px_rgba(0,0,0,0.35)]" hidden>
    <div class="font-bold mb-2">Beat Settings</div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>Kick range</label>
      <div class="flex items-center gap-1"><input id="kickFrom" type="number" min="20" max="20000" value="40" class="w-[60px]"> ‚Äì
      <input id="kickTo" type="number" min="20" max="20000" value="200" class="w-[60px]"></div>
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>Kick threshold</label>
      <input id="kickTh" type="range" min="0" max="1" step="0.01" value="0.6" />
      <span id="kickThVal">0.60</span>
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>Snare low</label>
      <div class="flex items-center gap-1"><input id="snareLowFrom" type="number" min="20" max="20000" value="120" class="w-[60px]"> ‚Äì
      <input id="snareLowTo" type="number" min="20" max="20000" value="250" class="w-[60px]"></div>
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>Snare high</label>
      <div class="flex items-center gap-1"><input id="snareHighFrom" type="number" min="20" max="20000" value="2000" class="w-[60px]"> ‚Äì
      <input id="snareHighTo" type="number" min="20" max="20000" value="5000" class="w-[60px]"></div>
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>Snare threshold</label>
      <input id="snareTh" type="range" min="0" max="1" step="0.01" value="0.5" />
      <span id="snareThVal">0.50</span>
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>Hat range</label>
      <div class="flex items-center gap-1"><input id="hatFrom" type="number" min="20" max="20000" value="6000" class="w-[60px]"> ‚Äì
      <input id="hatTo" type="number" min="20" max="20000" value="16000" class="w-[60px]"></div>
    </div>
    <div class="grid grid-cols-[1fr_auto] items-center gap-2.5 my-2">
      <label>Hat threshold</label>
      <input id="hatTh" type="range" min="0" max="1" step="0.01" value="0.45" />
      <span id="hatThVal">0.45</span>
    </div>
    <div class="flex justify-end gap-1.5">
      <button id="beatCancel" class="hover:bg-[#22365d]">Cancel</button>
      <button id="beatSave" class="hover:bg-[#22365d]">Save</button>
      <button id="beatClose" class="hover:bg-[#22365d]">Close</button>
    </div>
  </div>

  <!-- Drag & Drop Overlay -->
  <div id="dropzone" class="fixed inset-0 z-[1200] grid place-items-center bg-[rgba(4,10,20,0.65)] text-[18px] text-deep-text dark:text-dark-text pointer-events-none hidden">
    <div class="px-[22px] py-[18px] bg-[#0e1830] border border-white/10 rounded-xl shadow-[0_8px_26px_rgba(0,0,0,0.35)]">Drop audio files to add to the playlist‚Ä¶</div>
  </div>

  <div id="coverModal"><img alt="Cover" /></div>

  <script type="module" src="./src/main.js"></script>
</body>
</html>
