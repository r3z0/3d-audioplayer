<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Three.js + Audio Starter ‚Äî Plus</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>
  <div id="app"></div>

  <!-- Top HUD -->
    <div id="appControls" class="hud">
    <div class="row">
      <button id="micBtn" title="Use Microphone">üéôÔ∏è Mic</button>
      <input id="fileInput" type="file" accept="audio/*" multiple title="Add audio files"/>
      <button id="playBtn" title="Play / Pause">‚èµ</button>
      <button id="loopBtn" title="Loop Mode">üîÅ</button>
      <input id="scrubber" type="range" min="0" max="0" step="0.01" value="0" />
      <span id="timeNow">0:00</span>
      <span id="timeRemain">-0:00</span>
      <label class="vol">
        üîä
        <canvas id="vuMeter" width="10" height="40"></canvas>
        <canvas id="volumeKnob" width="50" height="50"></canvas>
        <input id="volume" type="range" min="0" max="1" step="0.01" value="0.8" hidden />
        <span id="volPct">80%</span>
      </label>
      <button id="btnFullscreen" title="Fullscreen">‚õ∂</button>
      <button id="btnSettings" title="Settings">‚öôÔ∏è</button>
      <button id="btnBeatConfig" title="Beat Settings">üéöÔ∏è</button>
      <button id="btnPlaylist" title="Toggle Playlist">üìú</button>
      <button id="smoothToggle" title="Smooth Transition">Smooth</button>
    </div>

      <div class="row meta">
      <span id="trackTitle">No track</span>
      <span id="trackStatus">stopped</span>

      <div class="meters">
        <canvas id="miniSpec" width="260" height="60"></canvas>
        <canvas id="miniWave" width="260" height="60"></canvas>
      </div>

      <div class="leds">
        <span id="ledSub"     class="led off">SUB</span>
        <span id="ledBass"    class="led off">BASS</span>
        <span id="ledLowMid"  class="led off">LOW‚ÄëMID</span>
        <span id="ledHighMid" class="led off">HIGH‚ÄëMID</span>
        <span id="ledHat"     class="led off">HI‚ÄëHAT</span>
      </div>
      </div>
    </div>

    <!-- Equalizer Panel -->
    <div id="eqPanel" class="eq-panel">
      <div id="eqSliders" class="eq-sliders">
        <div class="eq-band"><input class="eq-slider" data-band="0" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>32</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="1" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>64</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="2" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>125</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="3" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>250</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="4" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>500</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="5" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>1k</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="6" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>2k</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="7" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>4k</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="8" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>8k</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="9" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>16k</span></div>
      </div>
      <div class="eq-cuts">
        <div class="eq-cut">
          <label>HPF <input id="hpfSlider" type="range" min="20" max="1000" step="1" value="20" /></label>
          <label class="eq-toggle"><input id="hpfAudioToggle" type="checkbox" checked />Audio</label>
          <label class="eq-toggle"><input id="hpfLedToggle" type="checkbox" checked />LEDs</label>
        </div>
        <div class="eq-cut">
          <label>LPF <input id="lpfSlider" type="range" min="1000" max="20000" step="100" value="20000" /></label>
          <label class="eq-toggle"><input id="lpfAudioToggle" type="checkbox" checked />Audio</label>
          <label class="eq-toggle"><input id="lpfLedToggle" type="checkbox" checked />LEDs</label>
        </div>
        <label class="eq-toggle"><input id="eqAudioToggle" type="checkbox" checked />Audio</label>
        <label class="eq-toggle"><input id="eqLedToggle" type="checkbox" checked />LEDs</label>
        <label class="eq-overlay"><input id="eqOverlayToggle" type="checkbox" />Overlay</label>
      </div>
      <div class="eq-presets">
        <button class="eq-preset" data-preset="flat">Flat</button>
        <button class="eq-preset" data-preset="rock">Rock</button>
        <button class="eq-preset" data-preset="pop">Pop</button>
      </div>
    </div>

    <!-- Settings panel -->
    <div id="settingsPanel" class="panel" hidden>
    <div class="panel-title">Settings</div>
    <div class="panel-row">
      <label>Theme</label>
      <select id="themeSel">
        <option value="deep">Deep Blue (default)</option>
        <option value="dark">Dark Grey</option>
      </select>
    </div>
    <div class="panel-row">
      <label>Bloom</label>
      <input id="bloomStrength" type="range" min="0" max="1.2" step="0.01" value="0.55" />
      <span id="bloomVal">0.55</span>
    </div>
    <div class="panel-row">
      <label>Fog density</label>
      <input id="fogDensity" type="range" min="0" max="0.15" step="0.001" value="0.06" />
      <span id="fogVal">0.06</span>
    </div>
    <div class="panel-row">
      <label>FXAA</label>
      <input id="fxaaToggle" type="checkbox" checked />
    </div>
    <div class="panel-row">
      <label>Film grain</label>
      <input id="filmToggle" type="checkbox" checked />
    </div>
    <div class="panel-row">
      <label>Chromatic ab.</label>
      <input id="rgbToggle" type="checkbox" checked />
    </div>
    <div class="panel-row">
      <label>Beat timeline</label>
      <input id="beatToggle" type="checkbox" />
    </div>
    <div class="panel-row" id="eqRow">
      <label>Equalizer</label>
      <div id="eqSliders" class="eq-sliders">
        <div class="eq-band"><input class="eq-slider" data-band="0" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>32</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="1" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>64</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="2" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>125</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="3" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>250</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="4" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>500</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="5" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>1k</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="6" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>2k</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="7" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>4k</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="8" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>8k</span></div>
        <div class="eq-band"><input class="eq-slider" data-band="9" type="range" min="-12" max="12" step="0.1" value="0" orient="vertical" /><span>16k</span></div>
      </div>
    </div>
    <div class="panel-row" id="eqPresetRow">
      <label>Presets</label>
      <div class="eq-presets">
        <button class="eq-preset" data-preset="flat">Flat</button>
        <button class="eq-preset" data-preset="rock">Rock</button>
        <button class="eq-preset" data-preset="pop">Pop</button>
      </div>
    </div>
    <div class="panel-footer">
      <button id="clearBeats">Clear Beat Marks</button>
    </div>
  </div>

  <!-- Beat settings panel -->
  <div id="beatPanel" class="panel" style="left:auto; right:12px;" hidden>
    <div class="panel-title">Beat Settings</div>
    <div class="panel-row">
      <label>Kick range</label>
      <div><input id="kickFrom" type="number" min="20" max="20000" value="40" style="width:60px;"> ‚Äì
      <input id="kickTo" type="number" min="20" max="20000" value="200" style="width:60px;"></div>
    </div>
    <div class="panel-row">
      <label>Kick threshold</label>
      <input id="kickTh" type="range" min="0" max="1" step="0.01" value="0.6" />
      <span id="kickThVal">0.60</span>
    </div>
    <div class="panel-row">
      <label>Snare low</label>
      <div><input id="snareLowFrom" type="number" min="20" max="20000" value="120" style="width:60px;"> ‚Äì
      <input id="snareLowTo" type="number" min="20" max="20000" value="250" style="width:60px;"></div>
    </div>
    <div class="panel-row">
      <label>Snare high</label>
      <div><input id="snareHighFrom" type="number" min="20" max="20000" value="2000" style="width:60px;"> ‚Äì
      <input id="snareHighTo" type="number" min="20" max="20000" value="5000" style="width:60px;"></div>
    </div>
    <div class="panel-row">
      <label>Snare threshold</label>
      <input id="snareTh" type="range" min="0" max="1" step="0.01" value="0.5" />
      <span id="snareThVal">0.50</span>
    </div>
    <div class="panel-row">
      <label>Hat range</label>
      <div><input id="hatFrom" type="number" min="20" max="20000" value="6000" style="width:60px;"> ‚Äì
      <input id="hatTo" type="number" min="20" max="20000" value="16000" style="width:60px;"></div>
    </div>
    <div class="panel-row">
      <label>Hat threshold</label>
      <input id="hatTh" type="range" min="0" max="1" step="0.01" value="0.45" />
      <span id="hatThVal">0.45</span>
    </div>
    <div class="panel-footer">
      <button id="beatCancel">Cancel</button>
      <button id="beatSave">Save</button>
      <button id="beatClose">Close</button>
    </div>
  </div>

  <!-- Drag & Drop Overlay -->
  <div id="dropzone" class="dropzone" style="display:none;">
    <div>Drop audio files to add to the playlist‚Ä¶</div>
  </div>

  <div id="coverModal"><img alt="Cover" /></div>

  <script type="module" src="./src/main.js"></script>
</body>
</html>
